{
  "hash": "296f84f33ff55f57b383a408b50ae447",
  "result": {
    "markdown": "---\ntitle: \"Conhecendo o pacote geobr\"\nauthor: \"Beatriz Milz\"\ndate: \"2023-11-22\"\nformat: \n  rladies-revealjs:\n    footer: \"Slides feitos com [Quarto](https://quarto.org/docs/presentations/revealjs/index.html) e [Quarto R-Ladies Theme](https://github.com/beatrizmilz/quarto-rladies-theme#quarto-r-ladies-theme).\"\nincremental: false\nknitr:\n  opts_chunk:\n    echo: true\n    message: false\n    warning: false\n    error: false\n    cache: true\n    fig-align: center\n---\n\n\n## Pacote geobr\n\n-   O pacote **geobr** disponibiliza funções para obter diversas bases de dados **espaciais** oficiais do Brasil.\n\n-   O pacote foi desenvolvido e é mantido pela equipe do [IPEA - Instituto de Pesquisa Econômica Aplicada](https://www.ipea.gov.br/portal/).\n\n-   Você pode saber mais no repositório do pacote no GitHub: <https://ipeagit.github.io/geobr/>\n\n# Funções importantes\n\n-   `read_country()`: Delimitação do Brasil\n\n-   `read_state()`: Delimitação dos estados do Brasil\n\n-   `read_state(\"SP\")`: Delimitação de um estado específico, usando a sigla como argumento\n\n-   `read_municipality()`: Delimitação de todos os municípios do Brasil. É uma base pesada!\n\n-   `read_municipality(code_muni = 3550308)`: Delimitação de um município específico, usando o código do IBGE do município.\n\n## Consultando todas as funções disponíveis\n\n-   Função `list_geobr()`\n\n\n::: {.cell layout-align=\"center\" hash='slide-geobr_cache/revealjs/unnamed-chunk-1_02e8bbf2d1d8f49fb5cb5d3412045248'}\n::: {.cell-output-display}\n```{=html}\n<div class=\"reactable html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-c3c2b4f629b85b71ce65\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-c3c2b4f629b85b71ce65\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"function\":[\"`read_country`\",\"`read_region`\",\"`read_state`\",\"`read_meso_region`\",\"`read_micro_region`\",\"`read_intermediate_region`\",\"`read_immediate_region`\",\"`read_municipality`\",\"`read_municipal_seat`\",\"`read_weighting_area`\",\"`read_census_tract`\",\"`read_statistical_grid`\",\"`read_metro_area`\",\"`read_urban_area`\",\"`read_amazon`\",\"`read_biomes`\",\"`read_conservation_units`\",\"`read_disaster_risk_area`\",\"`read_indigenous_land`\",\"`read_semiarid`\",\"`read_health_facilities`\",\"`read_health_region`\",\"`read_neighborhood`\",\"`read_schools`\",\"`read_comparable_areas`\",\"`read_urban_concentrations`\",\"`read_pop_arrangements`\"],\"geography\":[\"Country\",\"Region\",\"States\",\"Meso region\",\"Micro region\",\"Intermediate region\",\"Immediate region\",\"Municipality\",\"Municipality seats (sedes municipais)\",\"Census weighting area (área de ponderação)\",\"Census tract (setor censitário)\",\"Statistical Grid of 200 x 200 meters\",\"Metropolitan areas\",\"Urban footprints\",\"Brazil's Legal Amazon\",\"Biomes\",\"Environmental Conservation Units\",\"Disaster risk areas\",\"Indigenous lands\",\"Semi Arid region\",\"Health facilities\",\"Health regions and macro regions\",\"Neighborhood limits\",\"Schools\",\"Historically comparable municipalities, aka Areas minimas comparaveis (AMCs)\",\"Urban concentration areas (concentrações urbanas)\",\"Population arrangements (arranjos populacioanis)\"],\"source\":[\"IBGE\",\"IBGE\",\"IBGE\",\"IBGE\",\"IBGE\",\"IBGE\",\"IBGE\",\"IBGE\",\"IBGE\",\"IBGE\",\"IBGE\",\"IBGE\",\"IBGE\",\"IBGE\",\"MMA\",\"IBGE\",\"MMA\",\"CEMADEN and IBGE\",\"FUNAI\",\"IBGE\",\"CNES, DataSUS\",\"DataSUS\",\"IBGE\",\"INEP\",\"IBGE\",\"IBGE\",\"IBGE\"]},\"columns\":[{\"id\":\"function\",\"name\":\"function\",\"type\":\"character\"},{\"id\":\"geography\",\"name\":\"geography\",\"type\":\"character\"},{\"id\":\"source\",\"name\":\"source\",\"type\":\"character\"}],\"defaultPageSize\":5,\"className\":\"smaller\",\"dataKey\":\"b125dea94351ad9a9e2bfbcbd78e3c47\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n## Conceitos importantes: Vetor x Raster\n\n![](img/vector-raster_1644589693.jpeg){fig-align=\"center\"}\n\n::: footer\nFonte da imagem: <https://guides.lib.uw.edu/>\n:::\n\n## Com o geobr, trabalhamos com dados vetoriais!\n\n-   **Pontos**: localização de uma escola, ponto de coleta, etc.\n\n-   **Linhas**: ruas/estradas/rodovias, rios, etc.\n\n-   **Polígonos**: delimitação de cidades, estados, países, etc.\n\n## Usamos uma nova classe de dados: sf!\n\n[![](img/sf_horst.png){fig-align=\"center\" width=\"90%\"}](https://github.com/allisonhorst/stats-illustrations)\n\n::: footer\nFonte da imagem: <https://github.com/allisonhorst/stats-illustrations>\n:::\n\n# Vamos para alguns exemplos!!\n\n## Ler a delimitação dos estados brasileiros\n\n\n::: {.cell layout-align=\"center\" hash='slide-geobr_cache/revealjs/unnamed-chunk-2_dabdcb259ec268273e81dca33bfb578d'}\n\n```{.r .cell-code}\n# Carregando pacotes necessários\nlibrary(geobr)\nlibrary(sf)\nlibrary(tidyverse)\n```\n:::\n\n::: {.cell layout-align=\"center\" hash='slide-geobr_cache/revealjs/unnamed-chunk-3_07c6b7bbf7e85eb9d124513b7ddaff70'}\n\n```{.r .cell-code}\n# Lendo os dados da delimitação dos estados brasileiros\nbrasil_ufs <- read_state(showProgress = FALSE)\n```\n:::\n\n::: {.cell layout-align=\"center\" hash='slide-geobr_cache/revealjs/unnamed-chunk-4_398a7a78e4477c5644085762d4abf104'}\n\n```{.r .cell-code}\n# Classe do objeto\nclass(brasil_ufs)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"sf\"         \"data.frame\"\n```\n:::\n:::\n\n\n## Explorando o objeto\n\n\n::: {.cell layout-align=\"center\" hash='slide-geobr_cache/revealjs/unnamed-chunk-5_44d9a92f60722e621e6c4799f1657e35'}\n\n```{.r .cell-code}\nglimpse(brasil_ufs)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 27\nColumns: 6\n$ code_state   <dbl> 11, 12, 13, 14, 15, 16, 17, 21, 22, 23, 24, 25, 26, 27, 2…\n$ abbrev_state <chr> \"RO\", \"AC\", \"AM\", \"RR\", \"PA\", \"AP\", \"TO\", \"MA\", \"PI\", \"CE…\n$ name_state   <chr> \"Rondônia\", \"Acre\", \"Amazonas\", \"Roraima\", \"Pará\", \"Amapá…\n$ code_region  <dbl> 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, …\n$ name_region  <chr> \"Norte\", \"Norte\", \"Norte\", \"Norte\", \"Norte\", \"Norte\", \"No…\n$ geom         <MULTIPOLYGON [°]> MULTIPOLYGON (((-63.32721 -..., MULTIPOLYGON…\n```\n:::\n:::\n\n\n## Visualizando os estados brasileiros\n\n\n::: {.cell layout-align=\"center\" hash='slide-geobr_cache/revealjs/unnamed-chunk-6_de078904bfd756b2ccdd547cfc8352e1'}\n\n```{.r .cell-code}\nbrasil_ufs |> \n  ggplot() +\n  geom_sf()\n```\n\n::: {.cell-output-display}\n![](slide-geobr_files/figure-revealjs/unnamed-chunk-6-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n## Filtrando o estado de São Paulo\n\n\n::: {.cell layout-align=\"center\" hash='slide-geobr_cache/revealjs/unnamed-chunk-7_633c699c510c31a7bb6b499807327e3f'}\n\n```{.r .cell-code}\nestado_sp <- brasil_ufs |> \n  filter(abbrev_state == \"SP\") \n\nestado_sp |>\n  ggplot() +\n  geom_sf()\n```\n\n::: {.cell-output-display}\n![](slide-geobr_files/figure-revealjs/unnamed-chunk-7-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n# E os municípios?\n\n\n::: {.cell layout-align=\"center\" hash='slide-geobr_cache/revealjs/unnamed-chunk-8_5a9425f2c0be1f763faf2d84a3ae6837'}\n\n```{.r .cell-code}\n# Carregando municípios\nbrasil_municipios <- read_municipality(showProgress = FALSE)\n```\n:::\n\n\n## Explorando o objeto\n\n\n::: {.cell layout-align=\"center\" hash='slide-geobr_cache/revealjs/unnamed-chunk-9_e81d49bfcd7bbce600bd01926ca5fb02'}\n\n```{.r .cell-code}\nglimpse(brasil_municipios)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 5,567\nColumns: 5\n$ code_muni    <dbl> 1100015, 1100023, 1100031, 1100049, 1100056, 1100064, 110…\n$ name_muni    <chr> \"Alta Floresta D'oeste\", \"Ariquemes\", \"Cabixi\", \"Cacoal\",…\n$ code_state   <chr> \"11\", \"11\", \"11\", \"11\", \"11\", \"11\", \"11\", \"11\", \"11\", \"11…\n$ abbrev_state <chr> \"RO\", \"RO\", \"RO\", \"RO\", \"RO\", \"RO\", \"RO\", \"RO\", \"RO\", \"RO…\n$ geom         <MULTIPOLYGON [°]> MULTIPOLYGON (((-62.2462 -1..., MULTIPOLYGON…\n```\n:::\n:::\n\n\n## Como saber o código IBGE de um município?\n\n-   Você pode consultar o código IBGE de um município no site do [IBGE](https://www.ibge.gov.br/explica/codigos-dos-municipios.php).\n\n[![](img/codigo-muni.png){fig-align=\"center\" width=\"80%\"}](https://www.ibge.gov.br/explica/codigos-dos-municipios.php)\n\n## Filtrando o município de São Paulo\n\n\n::: {.cell layout-align=\"center\" hash='slide-geobr_cache/revealjs/unnamed-chunk-10_a42c22b06b56b6b3373ce5eae07ab7fa'}\n\n```{.r .cell-code}\nmuni_sp <- brasil_municipios |> \n  dplyr::filter(code_muni == 3550308) \n```\n:::\n\n\n## Visualizando o município de São Paulo\n\n\n::: {.cell layout-align=\"center\" hash='slide-geobr_cache/revealjs/unnamed-chunk-11_aca3a79095f654338efdf0dc6859aee5'}\n\n```{.r .cell-code}\nmuni_sp |> \n  ggplot() +\n  geom_sf()\n```\n\n::: {.cell-output-display}\n![](slide-geobr_files/figure-revealjs/unnamed-chunk-11-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n## E escolas?\n\n\n::: {.cell layout-align=\"center\" hash='slide-geobr_cache/revealjs/unnamed-chunk-12_759e96b2d7a90b65cb540e9fb0fbe617'}\n\n```{.r .cell-code}\nescolas_brasil <- read_schools(showProgress = FALSE)\n```\n:::\n\n\n## Explorando o objeto\n\n\n::: {.cell layout-align=\"center\" hash='slide-geobr_cache/revealjs/unnamed-chunk-13_c871c3fb7e14085bd8a2058d2b6481e8'}\n\n```{.r .cell-code}\nglimpse(escolas_brasil)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 222,936\nColumns: 19\n$ abbrev_state                   <chr> \"RO\", \"RO\", \"RO\", \"RO\", \"RO\", \"RO\", \"RO…\n$ name_muni                      <chr> \"Porto Velho\", \"Porto Velho\", \"Porto Ve…\n$ code_school                    <int> 11000023, 11000040, 11000058, 11000082,…\n$ name_school                    <chr> \"EEEE ABNAEL MACHADO DE LIMA - CENE\", \"…\n$ education_level                <chr> \"Ensino Fundamental\", \"Educação Infanti…\n$ education_level_others         <chr> \"Atendimento Educacional Especializado\"…\n$ admin_category                 <chr> \"Pública\", \"Pública\", \"Privada\", \"Priva…\n$ address                        <chr> \"AVENIDA AMAZONAS, 6492 ZONA LESTE. TIR…\n$ phone_number                   <chr> \"(69) 992083054\", \"(69) 32135237\", \"(69…\n$ government_level               <chr> \"Estadual\", \"Municipal\", \"Privada\", \"Pr…\n$ private_school_type            <chr> \"Não Informado\", \"Não Informado\", \"Part…\n$ private_government_partnership <chr> \"Não\", \"Não\", \"Não\", \"Não\", \"Não\", \"Não…\n$ regulated_education_council    <chr> \"Não\", \"Sim\", \"Sim\", \"Sim\", \"Sim\", \"Sim…\n$ service_restriction            <chr> \"ESCOLA ATENDE EXCLUSIVAMENTE ALUNOS CO…\n$ size                           <chr> \"Entre 51 e 200 matrículas de escolariz…\n$ urban                          <chr> \"Urbana\", \"Urbana\", \"Urbana\", \"Urbana\",…\n$ location_type                  <chr> \"A escola não está em área de localizaç…\n$ date_update                    <chr> \"2020-10-18\", \"2020-10-18\", \"2020-10-18…\n$ geom                           <POINT [°]> POINT (-63.85401 -8.758459), POIN…\n```\n:::\n:::\n\n\n## Escolas no município de São Paulo\n\n\n::: {.cell layout-align=\"center\" hash='slide-geobr_cache/revealjs/unnamed-chunk-14_a9bcc324dc702f8b497188b243b4b46d'}\n\n```{.r .cell-code}\nescolas_saopaulo <- escolas_brasil |> \n  dplyr::filter(abbrev_state == \"SP\",\n         name_muni == \"São Paulo\") \n```\n:::\n\n\n## Escolas por `government_level`\n\n\n::: {.cell layout-align=\"center\" hash='slide-geobr_cache/revealjs/unnamed-chunk-15_3e608bd6477f57e67a512376883818ba'}\n\n```{.r .cell-code}\nescolas_saopaulo |> \n  dplyr::count(government_level)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 4 features and 2 fields\nGeometry type: MULTIPOINT\nDimension:     XY\nBounding box:  xmin: -46.8074 ymin: -23.90918 xmax: -46.36614 ymax: -23.3996\nGeodetic CRS:  SIRGAS 2000\n  government_level    n                           geom\n1         Estadual 1275 MULTIPOINT ((-46.75558 -23....\n2          Federal    4 MULTIPOINT ((-46.62169 -23....\n3        Municipal 1563 MULTIPOINT ((-46.7141 -23.8...\n4          Privada 5272 MULTIPOINT ((-46.7133 -23.8...\n```\n:::\n:::\n\n\n## Escolas que oferecem Ensino Médio\n\n\n::: {.cell layout-align=\"center\" hash='slide-geobr_cache/revealjs/unnamed-chunk-16_7513d16664ff9f9acbfb6bce0cab0b47'}\n\n```{.r .cell-code}\nensino_medio_sao_paulo <- escolas_saopaulo |>\n  dplyr::filter(stringr::str_detect(education_level, \"Ensino Médio\")) |>\n  dplyr::group_by(government_level) |> \n  dplyr::mutate(\n    numero_linhas = dplyr::n(),\n    nome_label = paste0(government_level, \" (N=\", numero_linhas, \")\")\n  ) |> \ndplyr::ungroup()\n```\n:::\n\n\n# Vamos visualizar?\n\n## Visualizando as escolas\n\n\n::: {.cell layout-align=\"center\" hash='slide-geobr_cache/revealjs/unnamed-chunk-17_36a99d2c1fa34c5a092cf478d01a5a34'}\n\n```{.r .cell-code}\nescolas_saopaulo |> \n  ggplot() +\n  geom_sf()\n```\n\n::: {.cell-output-display}\n![](slide-geobr_files/figure-revealjs/unnamed-chunk-17-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n## Visualizando as escolas e o município\n\n\n::: {.cell layout-align=\"center\" hash='slide-geobr_cache/revealjs/unnamed-chunk-18_1e40878a2756b1f2b6f81fb38cd5c99f'}\n\n```{.r .cell-code  code-line-numbers=\"3\"}\nescolas_saopaulo |> \n  ggplot() +\n  geom_sf(data = muni_sp) +\n  geom_sf()\n```\n\n::: {.cell-output-display}\n![](slide-geobr_files/figure-revealjs/unnamed-chunk-18-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n## Visualizando as escolas por `government_level`\n\n\n::: {.cell layout-align=\"center\" hash='slide-geobr_cache/revealjs/unnamed-chunk-19_73ede11de911e605a766267b85c40506'}\n\n```{.r .cell-code  code-line-numbers=\"4\"}\nescolas_saopaulo |> \n  ggplot() +\n  geom_sf(data = muni_sp) +\n  geom_sf(aes(color = government_level))\n```\n\n::: {.cell-output-display}\n![](slide-geobr_files/figure-revealjs/unnamed-chunk-19-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n## Visualizando as escolas por `government_level`\n\n\n::: {.cell layout-align=\"center\" hash='slide-geobr_cache/revealjs/unnamed-chunk-20_b99aad3496b3cd49962511bb2721165b'}\n\n```{.r .cell-code  code-line-numbers=\"5|4\"}\nescolas_saopaulo |> \n  ggplot() +\n  geom_sf(data = muni_sp) +\n  geom_sf(aes(color = government_level), show.legend = FALSE) +\n  facet_wrap(~government_level, nrow = 1)\n```\n\n::: {.cell-output-display}\n![](slide-geobr_files/figure-revealjs/unnamed-chunk-20-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n## Visualizando as escolas que oferecem Ensino Médio\n\n\n::: {.cell layout-align=\"center\" hash='slide-geobr_cache/revealjs/unnamed-chunk-21_a201f4d1aeac699702892f99c0354e44'}\n\n```{.r .cell-code  code-line-numbers=\"5\"}\nensino_medio_sao_paulo |>\n  ggplot() +\n  geom_sf(data = muni_sp) +\n  geom_sf(aes(color = government_level, \n              alpha = 0.1), \n          show.legend = FALSE) +\n  facet_wrap(~ government_level, nrow = 1)\n```\n\n::: {.cell-output-display}\n![](slide-geobr_files/figure-revealjs/unnamed-chunk-21-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n## \n\nLocalização das escolas estaduais e escolas privadas no município de São Paulo, que oferecem Ensino Médio\n\n\n::: {.cell layout-align=\"center\" hash='slide-geobr_cache/revealjs/unnamed-chunk-22_6f92437f7c3898413c756a7433a50289'}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Ver código\"}\nlibrary(ggspatial)\nensino_medio_sao_paulo |>\n  filter(government_level %in% c(\"Estadual\", \"Privada\")) |>\n  ggplot() +\n  geom_sf(data = muni_sp) +\n  geom_sf(aes(color = government_level, alpha = 0.1), show.legend = FALSE) +\n  facet_wrap(~ nome_label) +\n  labs(x = \"Longitude\",\n       y = \"Latitude\") +\n  scale_fill_viridis_d(begin = 0.2, end = 0.9) +\n  theme(legend.spacing.x = unit(1.0, 'cm')) +\n  theme_bw() +\n  theme(\n    panel.grid.major = element_line(\n      color = gray(0.9),\n      linetype = \"dashed\",\n      size = 0.1\n    ),\n    panel.background = element_rect(fill = \"white\")\n  ) +\n  theme(\n    axis.text.y = element_text(\n      angle = 90,\n      hjust = 0.5,\n      size = 8\n    ),\n    axis.text.x = element_text(size = 8),\n    axis.title.y = element_text(size = rel(0.8)),\n    axis.title.x = element_text(size = rel(0.8)),\n    legend.title = element_text(size = rel(0.8))\n  )\n```\n\n::: {.cell-output-display}\n![](slide-geobr_files/figure-revealjs/unnamed-chunk-22-1.png){fig-align='center' width=960}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/core-js-2.5.3/shim.min.js\"></script>\n<script src=\"site_libs/react-18.2.0/react.min.js\"></script>\n<script src=\"site_libs/react-18.2.0/react-dom.min.js\"></script>\n<script src=\"site_libs/reactwidget-1.0.0/react-tools.js\"></script>\n<script src=\"site_libs/htmlwidgets-1.6.2/htmlwidgets.js\"></script>\n<link href=\"site_libs/reactable-0.4.4/reactable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/reactable-binding-0.4.4/reactable.js\"></script>\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}